{"version":3,"sources":["lightbox.js"],"names":["getPageScroll","yScroll","self","pageYOffset","document","documentElement","scrollTop","body","arrayPageScroll","Array","getPageSize","xScroll","window","innerHeight","scrollMaxY","scrollWidth","scrollHeight","offsetHeight","offsetWidth","windowWidth","windowHeight","innerWidth","clientHeight","clientWidth","pageHeight","pageWidth","arrayPageSize","pause","numberMillis","now","Date","exitTime","getTime","getKey","e","keycode","event","keyCode","which","key","String","fromCharCode","toLowerCase","hideLightbox","listenKey","onkeypress","showLightbox","objLink","objOverlay","getElementById","objLightbox","objCaption","objImage","objLoadingImage","objLightboxDetails","style","top","height","left","width","display","imgPreload","Image","onload","src","href","lightboxTop","lightboxLeft","getAttribute","innerHTML","navigator","appVersion","indexOf","initLightbox","getElementsByTagName","anchors","i","length","anchor","onclick","this","objBody","item","createElement","setAttribute","position","zIndex","insertBefore","firstChild","imgPreloader","objLoadingImageLink","appendChild","loadingImage","nextSibling","imgPreloadCloseButton","objCloseButton","closeButton","objKeyboardMsg","addLoadEvent","func","oldonload"],"mappings":"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","file":"lightbox.js","sourcesContent":["var loadingImage = 'templates/lightbox/loading.gif';\nvar closeButton = 'templates/lightbox/close.gif';\n\nfunction getPageScroll() {\n  var yScroll;\n  if (self.pageYOffset) {\n    yScroll = self.pageYOffset;\n  } else if (document.documentElement && document.documentElement.scrollTop) {\n    yScroll = document.documentElement.scrollTop;\n  } else if (document.body) {\n    yScroll = document.body.scrollTop;\n  }\n  arrayPageScroll = new Array('', yScroll)\n  return arrayPageScroll;\n}\n\nfunction getPageSize() {\n  var xScroll, yScroll;\n  if (window.innerHeight && window.scrollMaxY) {\n    xScroll = document.body.scrollWidth;\n    yScroll = window.innerHeight + window.scrollMaxY;\n  } else if (document.body.scrollHeight > document.body.offsetHeight) {\n    xScroll = document.body.scrollWidth;\n    yScroll = document.body.scrollHeight;\n  } else {\n    xScroll = document.body.offsetWidth;\n    yScroll = document.body.offsetHeight;\n  }\n  var windowWidth, windowHeight;\n  if (self.innerHeight) {\n    windowWidth = self.innerWidth;\n    windowHeight = self.innerHeight;\n  } else if (document.documentElement && document.documentElement.clientHeight) {\n    windowWidth = document.documentElement.clientWidth;\n    windowHeight = document.documentElement.clientHeight;\n  } else if (document.body) {\n    windowWidth = document.body.clientWidth;\n    windowHeight = document.body.clientHeight;\n  }\n  if (yScroll < windowHeight) {\n    pageHeight = windowHeight;\n  } else {\n    pageHeight = yScroll;\n  }\n  if (xScroll < windowWidth) {\n    pageWidth = windowWidth;\n  } else {\n    pageWidth = xScroll;\n  }\n  arrayPageSize = new Array(pageWidth, pageHeight, windowWidth, windowHeight)\n  return arrayPageSize;\n}\n\nfunction pause(numberMillis) {\n  var now = new Date();\n  var exitTime = now.getTime() + numberMillis;\n  while (true) {\n    now = new Date();\n    if (now.getTime() > exitTime)\n      return;\n  }\n}\n\nfunction getKey(e) {\n  if (e == null) {\n    keycode = event.keyCode;\n  } else {\n    keycode = e.which;\n  }\n  key = String.fromCharCode(keycode).toLowerCase();\n  if (key == 'x') {\n    hideLightbox();\n  }\n}\n\nfunction listenKey() {\n  document.onkeypress = getKey;\n}\n\nfunction showLightbox(objLink) {\n  var objOverlay = document.getElementById('overlay');\n  var objLightbox = document.getElementById('lightbox');\n  var objCaption = document.getElementById('lightboxCaption');\n  var objImage = document.getElementById('lightboxImage');\n  var objLoadingImage = document.getElementById('loadingImage');\n  var objLightboxDetails = document.getElementById('lightboxDetails');\n  var arrayPageSize = getPageSize();\n  var arrayPageScroll = getPageScroll();\n  if (objLoadingImage) {\n    objLoadingImage.style.top = (arrayPageScroll[1] + ((arrayPageSize[3] - 35 - objLoadingImage.height) / 2) + 'px');\n    objLoadingImage.style.left = (((arrayPageSize[0] - 20 - objLoadingImage.width) / 2) + 'px');\n    objLoadingImage.style.display = 'block';\n  }\n  objOverlay.style.height = (arrayPageSize[1] + 'px');\n  objOverlay.style.display = 'block';\n  imgPreload = new Image();\n  imgPreload.onload = function() {\n    objImage.src = objLink.href;\n    var lightboxTop = arrayPageScroll[1] + ((arrayPageSize[3] - 35 - imgPreload.height) / 2);\n    var lightboxLeft = ((arrayPageSize[0] - 20 - imgPreload.width) / 2);\n    objLightbox.style.top = (lightboxTop < 0) ? \"0px\" : lightboxTop + \"px\";\n    objLightbox.style.left = (lightboxLeft < 0) ? \"0px\" : lightboxLeft + \"px\";\n    objLightboxDetails.style.width = imgPreload.width + 'px';\n    if (objLink.getAttribute('title')) {\n      objCaption.style.display = 'block';\n      objCaption.innerHTML = objLink.getAttribute('title');\n    } else {\n      objCaption.style.display = 'none';\n    }\n    if (navigator.appVersion.indexOf(\"MSIE\") != -1) {\n      pause(250);\n    }\n    if (objLoadingImage) {\n      objLoadingImage.style.display = 'none';\n    }\n    objLightbox.style.display = 'block';\n    arrayPageSize = getPageSize();\n    objOverlay.style.height = (arrayPageSize[1] + 'px');\n    listenKey();\n    return false;\n  }\n  imgPreload.src = objLink.href;\n}\n\nfunction hideLightbox() {\n  objOverlay = document.getElementById('overlay');\n  objLightbox = document.getElementById('lightbox');\n  objOverlay.style.display = 'none';\n  objLightbox.style.display = 'none';\n  document.onkeypress = '';\n}\n\nfunction initLightbox() {\n  if (!document.getElementsByTagName) {\n    return;\n  }\n  var anchors = document.getElementsByTagName(\"a\");\n  for (var i = 0; i < anchors.length; i++) {\n    var anchor = anchors[i];\n    if (anchor.getAttribute(\"href\") && (anchor.getAttribute(\"rel\") == \"lightbox\")) {\n      anchor.onclick = function() {\n        showLightbox(this);\n        return false;\n      }\n    }\n  }\n  var objBody = document.getElementsByTagName(\"body\").item(0);\n  var objOverlay = document.createElement(\"div\");\n  objOverlay.setAttribute('id', 'overlay');\n  objOverlay.onclick = function() {\n    hideLightbox();\n    return false;\n  }\n  objOverlay.style.display = 'none';\n  objOverlay.style.position = 'absolute';\n  objOverlay.style.top = '0';\n  objOverlay.style.left = '0';\n  objOverlay.style.zIndex = '90';\n  objOverlay.style.width = '100%';\n  objBody.insertBefore(objOverlay, objBody.firstChild);\n  var arrayPageSize = getPageSize();\n  var arrayPageScroll = getPageScroll();\n  var imgPreloader = new Image();\n  imgPreloader.onload = function() {\n    var objLoadingImageLink = document.createElement(\"a\");\n    objLoadingImageLink.setAttribute('href', '#');\n    objLoadingImageLink.onclick = function() {\n      hideLightbox();\n      return false;\n    }\n    objOverlay.appendChild(objLoadingImageLink);\n    var objLoadingImage = document.createElement(\"img\");\n    objLoadingImage.src = loadingImage;\n    objLoadingImage.setAttribute('id', 'loadingImage');\n    objLoadingImage.style.position = 'absolute';\n    objLoadingImage.style.zIndex = '150';\n    objLoadingImageLink.appendChild(objLoadingImage);\n    imgPreloader.onload = function() {};\n    return false;\n  }\n  imgPreloader.src = loadingImage;\n  var objLightbox = document.createElement(\"div\");\n  objLightbox.setAttribute('id', 'lightbox');\n  objLightbox.style.display = 'none';\n  objLightbox.style.position = 'absolute';\n  objLightbox.style.zIndex = '100';\n  objBody.insertBefore(objLightbox, objOverlay.nextSibling);\n  var objLink = document.createElement(\"a\");\n  objLink.setAttribute('href', '#');\n  objLink.setAttribute('title', 'Нажмите для закрытия');\n  objLink.onclick = function() {\n    hideLightbox();\n    return false;\n  }\n  objLightbox.appendChild(objLink);\n  var imgPreloadCloseButton = new Image();\n  imgPreloadCloseButton.onload = function() {\n    var objCloseButton = document.createElement(\"img\");\n    objCloseButton.src = closeButton;\n    objCloseButton.setAttribute('id', 'closeButton');\n    objCloseButton.style.position = 'absolute';\n    objCloseButton.style.zIndex = '200';\n    objLink.appendChild(objCloseButton);\n    return false;\n  }\n  imgPreloadCloseButton.src = closeButton;\n  var objImage = document.createElement(\"img\");\n  objImage.setAttribute('id', 'lightboxImage');\n  objLink.appendChild(objImage);\n  var objLightboxDetails = document.createElement(\"div\");\n  objLightboxDetails.setAttribute('id', 'lightboxDetails');\n  objLightbox.appendChild(objLightboxDetails);\n  var objCaption = document.createElement(\"div\");\n  objCaption.setAttribute('id', 'lightboxCaption');\n  objCaption.style.display = 'none';\n  objLightboxDetails.appendChild(objCaption);\n  var objKeyboardMsg = document.createElement(\"div\");\n  objKeyboardMsg.setAttribute('id', 'keyboardMsg');\n  objKeyboardMsg.innerHTML = 'Нажмите <kbd>X</kbd> для закрытия.';\n  objLightboxDetails.appendChild(objKeyboardMsg);\n}\n\nfunction addLoadEvent(func) {\n  var oldonload = window.onload;\n  if (typeof window.onload != 'function') {\n    window.onload = func;\n  } else {\n    window.onload = function() {\n      oldonload();\n      func();\n    }\n  }\n}\naddLoadEvent(initLightbox);\n"],"sourceRoot":"/source/"}